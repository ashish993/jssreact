"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.hmac = exports.digest = void 0;
var crypto_1 = require("crypto");
var fs_1 = require("fs");
/**
 * @param {string} path
 */
function digest(path) {
    return new Promise(function (resolve, reject) {
        var hash = crypto_1.createHash('sha256');
        fs_1.createReadStream(path)
            .pipe(hash.setEncoding('base64'))
            .on('error', function (err) { return reject(err); })
            .on('finish', function () { return resolve(hash.read()); });
    });
}
exports.digest = digest;
/**
 * @param {string[]} factors
 * @param {string} secret
 */
function hmac(factors, secret) {
    var mac = crypto_1.createHmac('sha256', secret);
    mac.setEncoding('base64');
    mac.write(factors.map(function (factor) { return factor.toLowerCase(); }).join('|'));
    mac.end();
    return mac.read();
}
exports.hmac = hmac;
