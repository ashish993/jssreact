"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.packageGenerate = void 0;
var sitecore_jss_update_package_1 = require("@sitecore-jss/sitecore-jss-update-package");
var fs_extra_1 = __importDefault(require("fs-extra"));
var path_1 = __importDefault(require("path"));
/**
 * @param {PackageGenerateOptions} options
 */
function packageGenerate(options) {
    // clear output folder
    fs_extra_1.default.emptyDirSync(options.outputPath);
    var datepath = "" + new Date().getTime();
    // manifest at temp path, need to save path for adding to metadata
    var manifestRelativePath = path_1.default.join('.', 'temp', options.appName, datepath);
    var packageManifestPath = path_1.default.join('.', options.outputPath, manifestRelativePath);
    fs_extra_1.default.copySync(path_1.default.join('.', options.manifestPath), packageManifestPath);
    // generate manifest package
    var updatePackage = path_1.default.join(options.outputPath, options.appName + "." + datepath + ".manifest.zip");
    return new Promise(function (resolve) {
        sitecore_jss_update_package_1.createPackage(packageManifestPath, updatePackage, resolve);
    });
}
exports.packageGenerate = packageGenerate;
